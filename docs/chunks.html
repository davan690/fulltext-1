<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 9 Chunks | fulltext manual</title>
  <meta name="description" content="Chapter 9 Chunks | fulltext manual">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 9 Chunks | fulltext manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 9 Chunks | fulltext manual" />
  <meta name="github-repo" content="ropensci/fulltext-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Chunks | fulltext manual" />
  
  <meta name="twitter:description" content="Chapter 9 Chunks | fulltext manual" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="fetch.html">
<link rel="next" href="table.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">fulltext manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> fulltext manual</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#info"><i class="fa fa-check"></i><b>1.1</b> Info</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#citing-fulltext"><i class="fa fa-check"></i><b>1.2</b> Citing fulltext</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.3</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#user-interface"><i class="fa fa-check"></i><b>2.1</b> User interface</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>3</b> Data sources</a><ul>
<li class="chapter" data-level="3.1" data-path="data-sources.html"><a href="data-sources.html#ds-search"><i class="fa fa-check"></i><b>3.1</b> Search</a></li>
<li class="chapter" data-level="3.2" data-path="data-sources.html"><a href="data-sources.html#ds-abstracts"><i class="fa fa-check"></i><b>3.2</b> Abstracts</a></li>
<li class="chapter" data-level="3.3" data-path="data-sources.html"><a href="data-sources.html#ds-link"><i class="fa fa-check"></i><b>3.3</b> Links</a></li>
<li class="chapter" data-level="3.4" data-path="data-sources.html"><a href="data-sources.html#ds-fulltext"><i class="fa fa-check"></i><b>3.4</b> Getting full text</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="authentication.html"><a href="authentication.html"><i class="fa fa-check"></i><b>4</b> Authentication</a></li>
<li class="chapter" data-level="5" data-path="search.html"><a href="search.html"><i class="fa fa-check"></i><b>5</b> Search</a><ul>
<li class="chapter" data-level="5.1" data-path="search.html"><a href="search.html#search-usage"><i class="fa fa-check"></i><b>5.1</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i><b>6</b> Abstract</a><ul>
<li class="chapter" data-level="6.1" data-path="abstract.html"><a href="abstract.html#abstract-usage"><i class="fa fa-check"></i><b>6.1</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>7</b> Links</a><ul>
<li class="chapter" data-level="7.1" data-path="links.html"><a href="links.html#links-usage"><i class="fa fa-check"></i><b>7.1</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fetch.html"><a href="fetch.html"><i class="fa fa-check"></i><b>8</b> Fetch</a><ul>
<li class="chapter" data-level="8.1" data-path="fetch.html"><a href="fetch.html#fetch-data-formats"><i class="fa fa-check"></i><b>8.1</b> Data formats</a></li>
<li class="chapter" data-level="8.2" data-path="fetch.html"><a href="fetch.html#how-data-is-stored"><i class="fa fa-check"></i><b>8.2</b> How data is stored</a></li>
<li class="chapter" data-level="8.3" data-path="fetch.html"><a href="fetch.html#fetch-usage"><i class="fa fa-check"></i><b>8.3</b> Usage</a></li>
<li class="chapter" data-level="8.4" data-path="fetch.html"><a href="fetch.html#fetch-errors"><i class="fa fa-check"></i><b>8.4</b> Errors</a></li>
<li class="chapter" data-level="8.5" data-path="fetch.html"><a href="fetch.html#fetch-cleanup"><i class="fa fa-check"></i><b>8.5</b> Cleanup</a></li>
<li class="chapter" data-level="8.6" data-path="fetch.html"><a href="fetch.html#fetch-internals"><i class="fa fa-check"></i><b>8.6</b> Internals</a></li>
<li class="chapter" data-level="8.7" data-path="fetch.html"><a href="fetch.html#fetch-notes"><i class="fa fa-check"></i><b>8.7</b> Notes about specific data sources</a><ul>
<li class="chapter" data-level="8.7.1" data-path="fetch.html"><a href="fetch.html#elsevier"><i class="fa fa-check"></i><b>8.7.1</b> Elsevier</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chunks.html"><a href="chunks.html"><i class="fa fa-check"></i><b>9</b> Chunks</a><ul>
<li class="chapter" data-level="9.1" data-path="chunks.html"><a href="chunks.html#chunks-usage"><i class="fa fa-check"></i><b>9.1</b> Usage</a></li>
<li class="chapter" data-level="9.2" data-path="chunks.html"><a href="chunks.html#chunks-tabularize"><i class="fa fa-check"></i><b>9.2</b> Tabularize</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>10</b> Table</a><ul>
<li class="chapter" data-level="10.1" data-path="table.html"><a href="table.html#table-usage"><i class="fa fa-check"></i><b>10.1</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="supplementary.html"><a href="supplementary.html"><i class="fa fa-check"></i><b>11</b> Supplementary</a></li>
<li class="chapter" data-level="12" data-path="use-cases.html"><a href="use-cases.html"><i class="fa fa-check"></i><b>12</b> Use cases</a></li>
<li class="chapter" data-level="13" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>13</b> Literature</a></li>
<li class="divider"></li>
<li><a href="https://github.com/ropensci/fulltext-book" target="blank">(c) Scott Chamberlain, 2017</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">fulltext manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chunks" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Chunks</h1>
<p>The <code>ft_chunks</code> function tries to make it easy to extract the parts of articles you want. This only works with XML format articles though since although we can get text out of PDFs, there is no machine readable way to say “I want the abstract”.</p>
<p>In addition to only working with XML, this function only has knowledge about a few select publishers for which we’ve coded knowledge about how to get different sections of the article. Not all publishers use the same format XML - so each publisher is slightly different for how to get to each section. That is, to get to the abstract requires slightly different xpath for publisher A vs. publisher B vs. publisher C.</p>
<div id="chunks-usage" class="section level2">
<h2><span class="header-section-number">9.1</span> Usage</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fulltext)
<span class="kw">library</span>(pubchunks)</code></pre>
<p>Get a full text article</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">ft_get</span>(<span class="st">&#39;10.1371/journal.pone.0086169&#39;</span>, <span class="dt">from=</span><span class="st">&#39;plos&#39;</span>)</code></pre>
<p>Note that unlike previous version of <code>fulltext</code> you now have to collect (<code>ft_collect()</code>) the text from the XML file on disk.
Then you can pass to <code>pub_chunks()</code>, here to get authors.</p>
<pre class="sourceCode r"><code class="sourceCode r">x <span class="op">%&gt;%</span><span class="st"> </span>ft_collect <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;authors&quot;</span>)</code></pre>
<pre><code>#&gt; $plos
#&gt; $plos$`10.1371/journal.pone.0086169`
#&gt; &lt;pub chunks&gt;
#&gt;   from: xml_document
#&gt;   publisher/journal: plos/PLoS ONE
#&gt;   sections: authors
#&gt;   showing up to first 5: 
#&gt;    authors (n=4): nested list
#&gt; 
#&gt; 
#&gt; attr(,&quot;ft_data&quot;)
#&gt; [1] TRUE</code></pre>
<p>In another example, let’s search for PLOS articles.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;rplos&quot;</span>)
(dois &lt;-<span class="st"> </span><span class="kw">searchplos</span>(<span class="dt">q=</span><span class="st">&quot;*:*&quot;</span>, <span class="dt">fl=</span><span class="st">&#39;id&#39;</span>,
   <span class="dt">fq=</span><span class="kw">list</span>(<span class="st">&#39;doc_type:full&#39;</span>,<span class="st">&quot;article_type:</span><span class="ch">\&quot;</span><span class="st">research article</span><span class="ch">\&quot;</span><span class="st">&quot;</span>),
     <span class="dt">limit=</span><span class="dv">5</span>)<span class="op">$</span>data<span class="op">$</span>id)</code></pre>
<pre><code>#&gt; [1] &quot;10.1371/journal.pone.0155491&quot; &quot;10.1371/journal.pone.0168627&quot;
#&gt; [3] &quot;10.1371/journal.pone.0184491&quot; &quot;10.1371/journal.pone.0155489&quot;
#&gt; [5] &quot;10.1371/journal.pone.0127059&quot;</code></pre>
<p>Then get the full text</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">ft_get</span>(dois, <span class="dt">from=</span><span class="st">&quot;plos&quot;</span>)</code></pre>
<p>Then pull out various sections of each article.</p>
<blockquote>
<p>remember to pull out the full text first</p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">ft_collect</span>(x)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;front&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;body&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;back&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;history&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;authors&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="kw">c</span>(<span class="st">&quot;doi&quot;</span>,<span class="st">&quot;categories&quot;</span>))
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;all&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;publisher&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;acknowledgments&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;permissions&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;journal_meta&quot;</span>)
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pub_chunks</span>(<span class="st">&quot;article_meta&quot;</span>)</code></pre>
</div>
<div id="chunks-tabularize" class="section level2">
<h2><span class="header-section-number">9.2</span> Tabularize</h2>
<p>The function <code>pub_tabularize()</code> is useful for coercing the output of <code>pub_chunks()</code> into a data.frame,
the lingua franca of data work in R.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
x &lt;-<span class="st"> </span><span class="kw">pub_chunks</span>(x, <span class="kw">c</span>(<span class="st">&quot;doi&quot;</span>, <span class="st">&quot;title&quot;</span>))
x &lt;-<span class="st"> </span><span class="kw">pub_tabularize</span>(x)
<span class="kw">rbindlist</span>(x<span class="op">$</span>plos, <span class="dt">fill =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>#&gt;                             doi
#&gt; 1: 10.1371/journal.pone.0155491
#&gt; 2: 10.1371/journal.pone.0168627
#&gt; 3: 10.1371/journal.pone.0184491
#&gt; 4: 10.1371/journal.pone.0155489
#&gt; 5: 10.1371/journal.pone.0127059
#&gt;                                                                                                                                        title
#&gt; 1:                            Uterine Expression of NDRG4 Is Induced by Estrogen and Up-Regulated during Embryo Implantation Process in Mice
#&gt; 2:                                                             Galectin-3 and Its Genetic Variation rs4644 Modulate Enterovirus 71 Infection
#&gt; 3: Ethics approval in applications for open-access clinical trial data: An analysis of researcher statements to clinicalstudydatarequest.com
#&gt; 4:                                      Risk Factors for Distant Metastasis in Patients with Minimally Invasive Follicular Thyroid Carcinoma
#&gt; 5:                                   Seasonal Differences in Extinction and Colonization Drive Occupancy Dynamics of an Imperilled Amphibian
#&gt;    .publisher
#&gt; 1:       plos
#&gt; 2:       plos
#&gt; 3:       plos
#&gt; 4:       plos
#&gt; 5:       plos</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fetch.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="table.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ropensci/fulltext-book/edit/master/08-chunks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
